Index: logtool-HEAD/src/Protocol_V10.cc
===================================================================
RCS file: /var/cvsintern/wamas_x/utilities/logging/cpp/logtool/src/Protocol_V10.cc,v
retrieving revision 1.2
diff -u -r1.2 Protocol_V10.cc
--- logtool-HEAD/src/Protocol_V10.cc	22 Jan 2009 10:49:09 -0000	1.2
+++ logtool-HEAD/src/Protocol_V10.cc	10 Feb 2009 13:07:45 -0000
@@ -162,10 +162,10 @@
                         
             // message
             tmp = sep+1;
-            if ( ( sep = data.find(LOG_SEP, tmp)) <= len ) {
-                throw LogToolError("Protocol_V10::parse(MESSAGE) -> data string too long !");
-            }
             msg->message(std::string(data, tmp));
+            if (msg->message().size() != len-tmp) {
+                throw LogToolError("Protocol_V10::parse(MESSAGE) -> data string does not fit message length");
+            }
 
             // receivedBytes
             msg->receivedBytes(msg->message().size());
